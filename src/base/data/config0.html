<h2 class="content-subhead">System</h2>

<form class="pure-form pure-form-aligned" id='f0' method='POST' action='/rbt'>
    <fieldset>                    
        <div class="pure-controls">
            <input type='submit' name='subRbt' id='subRbt' value='Reboot' class="pure-button pure-button-primary" style="background: rgb(223, 117, 20);">
        </div>
    </fieldset>
</form>
<form class="pure-form pure-form-aligned" id='f0b' method='POST' action='/rbtrsc'>
    <fieldset>                    
        <div class="pure-controls">
            <input type='submit' name='subRbtRsc' id='subRbtRsc' value='Reboot in Rescue Mode' class="pure-button pure-button-primary" style="background: rgb(202, 60, 60);">
        </div>
    </fieldset>
</form>
<span id='r0'></span>

<script>
    function postFailed(){
        $('#r0').innerHTML = '<span style="color: red;"><b>Failed</b></span>';
        $('#f0').reset();
        $('#f0b').reset();
        $('#subRbt').disabled = false;
        $('#subRbtRsc').disabled = false;
    };
    
    $("#f0").addEventListener('submit', function (evt) {
        evt.preventDefault();
        $('#subRbt').disabled = true;
        $('#subRbtRsc').disabled = true;

        post('/rbt', null, function () {
            $('#r0').innerHTML = '<h3><span style="color: green;"><b>Done</b></span> System will reboot shortly. Go back to Status page and look for UpTime reset. This page will be reloaded in <span id="cd">20</span>sec.</h3>';
            runScript('var count=19;var cdi=setInterval(function(){$("#cd").innerText=count;if(!count){clearInterval(cdi);location.reload();}count--;},1000);');
        }, postFailed);
    });

    $("#f0b").addEventListener('submit', function (evt) {
        evt.preventDefault();
        $('#subRbt').disabled = true;
        $('#subRbtRsc').disabled = true;

        post('/rbtrsc', null, function () {
            $('#r0').innerHTML = '<h3><span style="color: green;"><b>Done</b></span> System will reboot shortly in RESCUE MODE. This page will be reloaded in <span id="cd">20</span>sec.</h3>';
            runScript('var count=19;var cdi=setInterval(function(){$("#cd").innerText=count;if(!count){clearInterval(cdi);location.reload();}count--;},1000);');
        }, postFailed);
    });
</script>